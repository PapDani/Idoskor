<section class="wrap">
  <header class="head">
    <h1>Kártyák</h1>
  </header>

  <table class="grid">
    <thead>
      <tr>
        <th style="width:36px"></th>
        <th style="width:70px;text-align:right">#</th>
        <th>ID</th>
        <th>Cím</th>
        <th>Cikk hozzárendelés</th>
        <th>Publikus megnyitás</th>
        <th>Admin műveletek</th>
      </tr>
    </thead>
    <tbody cdkDropList (cdkDropListDropped)="drop($event)">
      <tr *ngFor="let c of cards; let i = index; trackBy: trackId" cdkDrag>
        <td class="drag-cell"><span cdkDragHandle class="handle" title="Húzd a rendezéshez">↕</span></td>
        <td class="order-cell">{{ i + 1 }}</td>
        <td>{{ c.id }}</td>
        <td>{{ c.title }}</td>

        <td>
          <mat-select [value]="c.pageKey || null" (selectionChange)="setPage(c, $event.value)" placeholder="— válassz cikket —">
            <mat-option [value]="null">— nincs —</mat-option>
            <mat-option *ngFor="let p of pages" [value]="p.key">{{ p.title }}</mat-option>
          </mat-select>
          <button mat-stroked-button color="warn" *ngIf="c.pageKey" (click)="clearPage(c)">Leválaszt</button>
        </td>

        <td>
          <a *ngIf="c.pageKey; else ext" [routerLink]="['/pages', c.pageKey]">Cikk megnyitása</a>
          <ng-template #ext>
            <a *ngIf="c.contentUrl" [href]="c.contentUrl" target="_blank" rel="noopener">Külső link</a>
            <span *ngIf="!c.contentUrl" class="muted">—</span>
          </ng-template>
        </td>

        <td class="actions">
          <button mat-stroked-button (click)="edit(c)">Szerkesztés</button>
          <button mat-stroked-button color="warn" (click)="delete(c)">Törlés</button>
        </td>
      </tr>
    </tbody>
  </table>
</section>

<style>
  .wrap {
    max-width: 1100px;
    margin: 1rem auto;
    padding: 0 1rem
  }

  .head {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: .75rem
  }

  table.grid {
    width: 100%;
    border-collapse: collapse;
    background: #fff
  }

    table.grid th, table.grid td {
      border-bottom: 1px solid #e6e6e6;
      padding: .5rem .4rem;
      text-align: left;
      vertical-align: middle
    }

  td.actions {
    display: flex;
    gap: .5rem;
    align-items: center
  }

  .muted {
    color: #888
  }

  .drag-cell {
    width: 36px;
    text-align: center
  }

  .handle {
    cursor: grab;
    user-select: none
  }

  .order-cell {
    text-align: right;
    font-variant-numeric: tabular-nums;
    color: #555;
    width: 70px
  }

  tr.cdk-drag-preview {
    box-shadow: 0 6px 18px rgba(0,0,0,.2);
    background: #fff
  }

  tr.cdk-drag-animating {
    transition: transform .2s
  }

  tbody.cdk-drop-list-dragging tr:not(.cdk-drag-placeholder) {
    transition: transform .2s
  }
</style>
